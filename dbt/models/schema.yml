version: 2

sources:
  - name: instacart_raw
    # no database on sparksql
    # database: dbtdb 
    schema: source
    tables:
      - name: aisles
      - name: departments
      - name: orders
      - name: products
      - name: order_products__train
      - name: order_products__prior

models:
  - name: clean_orders
    description: "Hudi insert non-partitioned table with incremental materialization"
    schema: sample
    columns:
      - name: order_id
        description: "The primary key for this table"
        tests:
            - unique
            - not_null
  - name: order_products
    description: "Hudi insert non-partitioned table with incremental materialization"
    schema: sample
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - order_id
            - product_id
    columns:
      - name: order_id
        description: "The primary key for this table"
        tests:
            - not_null
      - name: product_id
        description: "The primary key for this table"
        tests:
            - not_null